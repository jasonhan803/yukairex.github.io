<!DOCTYPE html>
<html>
<title>Nebulas Fantasy</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karma">
<link href="css/bootstrap.min.css" rel="stylesheet">
<style>
        body,h1,h2,h3,h4,h5,h6 {font-family: sans-serif, Arial, Helvetica,宋体}
        .w3-bar-block .w3-bar-item {padding:20px}
        .buyPlayer {
            margin: auto;
            width: 50%;
            padding: 10px;
        }
        img {
            display:block;
            margin:auto;
        }
        .sectionTitle {
        font-weight: bold;
        padding: 20px; 
    }
</style>
<body>

        <!-- Sidebar (hidden by default)
        <nav class="w3-sidebar w3-bar-block w3-card w3-top w3-xlarge w3-animate-left" style="display:none;z-index:2;width:40%;min-width:300px" id="mySidebar">
                <a href="javascript:void(0)" onclick="w3_close()"
        class="w3-bar-item w3-button">Close</a>
        <a href="./index.html" onclick="w3_close()" class="w3-bar-item w3-button">Home</a>
        <a href="./index.html#howToPlay" onclick="w3_close()" class="w3-bar-item w3-button">How to Play</a>
        <a href="./index.html#about" onclick="w3_close()" class="w3-bar-item w3-button">About</a>
        <a href="./index.html#FAQ" onclick="w3_close()" class="w3-bar-item w3-button">FAQ</a>
        </nav> -->

    <div class="container">
        <div class="w3-white w3-xlarge" style="max-width:1200px;">
                <div class="w3-bar">
                        <a href="./index.html" class="w3-bar-item w3-button w3-mobile">Home</a>
                        <a href="./players.html" class="w3-bar-item w3-button w3-mobile">Portfolio</a>
                        <a href="./market.html" class="w3-bar-item w3-button w3-mobile">Market</a>
                        <a href="./about.html" class="w3-bar-item w3-button w3-mobile">About</a>
                        <a href="" id="contractAddress" class="w3-bar-item w3-button w3-mobile">Contract</a>
                        <a href="./ch/about.html" class="w3-bar-item w3-button w3-mobile" style="float:right">中文</a>
                        <span class="w3-bar-item w3-mobile" id="pool" style="float:right"></span>
                </div>
        </div>

        <header class="w3-display-container w3-content w3-wide" style="max-width:1600px;min-width:500px" id="home">
            <img class="w3-image" src="./img/banner0.png">
        </header>



        <div class=class="w3-main w3-content w3-padding" style="max-width:1200px;margin-top:100px">
            <h2 class="sectionTitle"> What is Nebulas Fantasy</h2>
            <ul>
                <li><h3> Nebulas Fantasy is a decentralized application that operates on the Nebulas Network.</h3></li>                  
                <li><h3> We setup a fantasy platform for everyone to enjoy World Cup 2018 in a unique manner </h3></li>
                <li><h3> You can own soccer players on Nebulas blockchain, gain points according to the their performance in the real World Cup matches, and reward NAS as prize!</h3></li>
            </ul>
           
    
            <br>
            <h2 class="sectionTitle"> How to play Nebulas Fantasy</h2>
            <ul>
                <li><h3>Step1: You claim ownership of soccer players on Nebulas blockchain. The amount of NAS as claim fee will enter the total prize pool.</h3></li>
                <li><h3>Step2: Players will accumulate experience points based on their performance in the real World Cup games. For example, a player gains 300pts for every goal in the real match.</h3></li>
                <li><h3>Step3: After World Cup ends on 07/15, owners of players with the top 50 highest scores will be able to share the total prize.</h3></li>
                <li><h3>Extra: During the World Cup, you can transfer your player to your friends/family, or trade players on an open market.</h3></li>
            </ul>

            <br>
            <h2 class="sectionTitle"> What is a player</h2>
            <ul>
                <li><h3> A player in Nebulas Fantasy is a NRC721 token on Nebulas blockchain. We selected the top-tier soccer stars for game simplicity. Once claimed, the player (or this NRC721) token will be associated with your NAS address, and recorded on the Nebulas Blockchain. You can transfer this player to others as you like.</h3></li>
                <li><h3> There are two ways to claim a player. You can spend a little NAS to claim a random player. Or you can pay premium to claim a specific superstar on the open market. You can claim players through the World Cup, but your player won’t be able to receive points before the player is generated. </h3></li>   
                <li><h3> Each player is generated with a talent value (i.e. 1-5). For the same performance, a player with a higher talent score more points.</h3></li>
                <li><h3> For every 50 players generated via lottery, the lottery price will increase by 0.1NAS. </h3></li>
                <li><h3> For every specific player generated via open market, the price for that specific player will increase by 0.02NAS. </h3></li>
                <li><h3> For every minute a player plays, he will score 1 points x his talent. </h3></li>
                <li><h3> For every winning game, a player will score 100 pts; </h3></li>
                <li><h3> For every goal a player made, he will score 300 pts </h3></li>
                <li><h3> The total score of a player  = minutes he played * talent + # of winning game*100 + # of goals *300 </h3></li>
            </ul>

            <br>
            <h2 class="sectionTitle"> Reward Rule</h2>
            <ul>
                <li><h3> Once the World Cup ends on 7/15, players will be ranked according to the points </h3></li>
                <li><h3> The top 3 players will receive 25%,150% and 10% of the total prize pool, correspondingly. </h3></li>   
                <li><h3> The 4-10th players will evenly share 15% of prize pool.</h3></li>
                <li><h3> The 11-30th players will evenly share 15% of prize pool.</h3></li>
                <li><h3> The 31-50th players will evenly share 10% of prize pool.</h3></li>
                <li><h3> The Nebulas Fantasy Team will get 10% of the total prize pool as maintenance fee.</h3></li>
            </ul>

        </div>


          


  
 

<!-- End page content -->
</div>
<script src=./lib/jquery-3.3.1.min.js></script>
<script src= "bootstrap.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src=../lib/nebpay.js></script>
<script src=../lib/nebulas.js></script>
<script src='address.js'></script>

<script>
        var nebulas = require("nebulas"),
        neb = new nebulas.Neb();
        var NebPay = require("nebpay");
        var nebPay = new NebPay();
        var serialNumber;
        Account = nebulas.Account;
        var account;

        var mainnetUrl = "https://pay.nebulas.io/api/mainnet/pay",
        testnetUrl = "https://pay.nebulas.io/api/pay";

        var ownerAddress;
        var explorerTex, explorer, chainId, callbackUrl, NebHttpRequest;    

        if(mainnet==false){ // test net
            // const contractAddress =  require("address");//"n1wtjL3KMVNTV3gsWhJibnNMmr6HJHKwBW2";
            ownerAddress = "n1RQYWMLqy1twJhfYxPk4SFx7wdfeq31pMX";
            NebHttpRequest = "https://testnet.nebulas.io";
            chainId = 1001;// test net
            callbackUrl = testnetUrl;
            explorerTx = "https://explorer.nebulas.io/#/testnet/tx/";
            explorer = "https://explorer.nebulas.io/#/testnet/address/";
        }else
        {
            // //main net 
            ownerAddress = "n1bveJ8tkb1DDECgHvknRFZesJqeaL2iKNt";
            NebHttpRequest = "https://mainnet.nebulas.io";
            chainId = 1;// mainnet net
            callbackUrl = mainnetUrl;
            explorerTx = "https://explorer.nebulas.io/#/mainnet/tx/";
            explorer = "https://explorer.nebulas.io/#/mainnet/address/";
        }

            neb.setRequest(new nebulas.HttpRequest(NebHttpRequest));
            $("#contractAddress").attr('href', explorer + contractAddress).attr('target', "_blank");
   

   



//         function buy() {
//             var to = contractAddress;
//             var value = 0;// need to change
//             var callFunction = "mint";
//             var callArgs = "";
//             serialNumber = nebPay.call(to, value, callFunction, callArgs, {    //使用nebpay的call接口去调用合约,
//                 listener: mintListener,        //设置listener, 处理交易返回信息
//             });
//         }

//         var txhash;

//         function mintListener(resp) {
//             txhash = resp.txhash;
//             neb.api.getTransactionReceipt({
//                 hash: resp.txhash
//             })
//                 .then(function (receipt) {
//                     console.log("receipt is:" + JSON.stringify(receipt))
//                     setQuery = setInterval(function () {
//                         setTxQuery();
//                     }, 10000);
//                 })
//         }

//             function setTxQuery() {
//             neb.api.getTransactionReceipt({
//                 hash: txhash
//             })
//                 .then(function (receipt) {
//                     console.log(receipt)
//                     if (receipt.status ==1){
//                         console.log("tx success")
//                         var playerId = JSON.parse(receipt.execute_result);
//                         console.log(playerId)
//                         loadPlayerPicsById(playerId);
//                         clearInterval(setQuery);
//                     }

//                    if (receipt.status ==0){
//                         console.log("tx fail")
//                         clearInterval(setQuery);
//                     }
                    
//                 })
//                 .catch(function (err) {
//                     console.log("didn't get a receipt")
//                 })
//         }

    function init(){
        console.log("in the initial function");
        getTotalPrize();        
    }


       var temp
        
        // check the prize pool
        function getTotalPrize() {
                var testcontract;
                var callJSONs = {
                    from: ownerAddress, // get address string
                    to: contractAddress, // get the contract string
                    value: "0",
                    nonce: 0,
                    gasPrice: "200000",
                    gasLimit: "1000000",
                    contract: testcontract
                }

                // get the token Id owned by the address
                testcontract = { "function": "getPrizePool", "args": "" };
                callJSONs.contract = testcontract;
                neb.api.call(callJSONs)
                .then(function (resp){
                    
                    // $("#prize").show().text("Total prize pool:  " + String(parseInt(JSON.parse(resp.result)) / 1e18) + " NAS");
                    $("#pool").show().text(String(parseInt(JSON.parse(resp.result)) / 1e18) + " NAS in pool");
                    }   
                )
        };

        
        $(window).load(function () {
            // executes when complete page is fully loaded, including all frames, objects and images
                window.postMessage({
                "target": "contentscript",
                "data":{},
                "method": "getAccount",
                }, "*");
     
                window.addEventListener('message', function(e) {
                    if(!!e.data.data.account){
                        account = e.data.data.account;
                    } 
                    // console.log(account)
                });  
                
                init();
        });
    </script>

</body>
</html>
